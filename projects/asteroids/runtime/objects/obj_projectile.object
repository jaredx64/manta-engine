#include <object_api.hpp>

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Includes

HEADER_INCLUDES
// ...

SOURCE_INCLUDES
#include <scene.hpp>
#include <manta/window.hpp>
#include <manta/input.hpp>
#include <manta/draw.hpp>
#include <core/math.hpp>

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Object

OBJECT( obj_projectile )

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Data

PUBLIC float x;
PUBLIC float y;
PUBLIC float speed;
PUBLIC float direction = 0.0f;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Events

EVENT_CREATE
{
}

EVENT_UPDATE
{
	// Movement
	x += lengthdir_x( speed * delta, direction );
	y += lengthdir_y( speed * delta, direction );

	// Destroy
	if( x < 0.0f || x > static_cast<float>( Window::width ) || y < 0.0f || y > static_cast<float>( Window::height ) )
	{
		Scene::objects.destroy( id );
		return;
	}
}

EVENT_RENDER
{
	draw_sprite_angle( spr_fire_beam, 0, x, y, direction, 1.0f, 1.0f, c_white, 0.0f );
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Functions